<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Individual-Based Forest Growth Simulator TROLL • rcontroll</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Individual-Based Forest Growth Simulator TROLL">
<meta property="og:description" content="TROLL is coded in C++ and it typically simulates hundreds of thousands of individuals over hundreds of years. The rcontroll R package is a wrapper of TROLL. rcontroll includes functions that generate inputs for simulations and run simulations. Finally, it is possible to analyse the TROLL outputs through tables, figures, and maps taking advantage of other R visualisation packages. rcontroll also offers the possibility to generate a virtual LiDAR point cloud that corresponds to a snapshot of the simulated forest.">
<meta property="og:image" content="https://sylvainschmitt.github.io/rcontroll/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">rcontroll</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/climate.html">Generate climate data</a>
    </li>
    <li>
      <a href="articles/lidar.html">Lidar simulation using TROLL</a>
    </li>
    <li>
      <a href="articles/troll.html">The TROLL model</a>
    </li>
    <li>
      <a href="articles/workflow.html">A simple workflow</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sylvainschmitt/rcontroll/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="rcontroll-individual-based-forest-growth-simulator-troll-">
<em>rcontroll</em>: individual-based forest growth simulator TROLL <img src="reference/figures/logo.png" align="right" height="200"><a class="anchor" aria-label="anchor" href="#rcontroll-individual-based-forest-growth-simulator-troll-"></a>
</h1></div>
<!-- sticker("~/Téléchargements/TROLL.png", package="rcontroll", p_size=20, s_x=1, s_y = 0.85, s_width=.6, p_y = 1.6, filename="inst/figures/logo.png", h_color = "darkblue", h_fill = "white", p_color = "black") -->
<p><a href="https://github.com/sylvainschmitt/rcontroll/actions" class="external-link"><img src="https://github.com/sylvainschmitt/rcontroll/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a> <a href="https://CRAN.R-project.org/package=rcontroll" class="external-link"><img src="https://www.r-pkg.org/badges/version/rcontroll" alt="CRAN"></a> <a href="http://www.r-pkg.org/pkg/rcontroll" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/rcontroll?color=brightgreen" alt="Downloads"></a> <a href="https://codecov.io/gh/sylvainschmitt/rcontroll" class="external-link"><img src="https://codecov.io/gh/sylvainschmitt/rcontroll/branch/main/graph/badge.svg?token=CGZU65KGN7" alt="codecov"></a> <a href="https://github.com/sylvainschmitt/rcontroll/actions?query=workflow%3Alint" class="external-link"><img src="https://github.com/sylvainschmitt/rcontroll/workflows/lint/badge.svg" alt="lint"></a> <a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a> <a href="https://zenodo.org/badge/latestdoi/382141143" class="external-link"><img src="https://zenodo.org/badge/382141143.svg" alt="DOI"></a></p>
<p><em>rcontroll</em> integrates the individual-based and spatially-explicit <em>TROLL</em> model to simulate forest ecosystem and species dynamics forward in time. <em>rcontroll</em> provides user-friendly functions to set up and analyse simulations with varying community compositions, ecological parameters, and climate conditions.</p>
<div class="section level2">
<h2 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h2>
<p><code>TROLL</code> is coded in C++ and it typically simulates hundreds of thousands of individuals over hundreds of years. The <code>rcontroll</code> R package is a wrapper of <code>TROLL</code>. <code>rcontroll</code> includes functions that generate inputs for simulations and run simulations. Finally, it is possible to analyse the <code>TROLL</code> outputs through tables, figures, and maps taking advantage of other R visualisation packages. <code>rcontroll</code> also offers the possibility to generate a virtual LIDAR point cloud that corresponds to a snapshot of the simulated forest.</p>
<div class="section level3">
<h3 id="construction-and-manipulation-of-input-files">Construction and manipulation of input files<a class="anchor" aria-label="anchor" href="#construction-and-manipulation-of-input-files"></a>
</h3>
<p>As stated above, three types of input data are needed for a typical <code>TROLL</code> simulation: (i) climate data, (ii) plant functional traits, (iii) global model parameters. Pre-simulation functions include global parameters definition (<code>generate_parameters</code> function) and climate data generation (<code>generate_climate</code> function). <code>rcontroll</code> also includes default data for species and climate inputs for a typical French Guiana rainforest site. The purpose of the <code>generate_climate</code> function with the help of the corresponding vignette is to create <code>TROLL</code> climate inputs from ERA5-Land (Muñoz-Sabater et al. 2021), a global climatic reanalysis dataset that is freely available. The ERA5-Land climate reanalysis is available at 9 km spatial resolution and hourly temporal resolution since 1950, and daily or monthly means are available and their uncertainties reported. Therefore, <code>rcontroll</code> users only need to input the species-specific trait data to run <code>TROLL</code> simulations, irrespective of the site. <code>TROLL</code> was originally developed for tropical and subtropical forests, so certain assumptions must be critically examined when applying it outside the tropics. The input files can be used to start a <code>TROLL</code> simulation run within the <code>rcontroll</code> environment (see below), or saved so that the <code>TROLL</code> simulation can be started as a command line tool.</p>
</div>
<div class="section level3">
<h3 id="simulations">Simulations<a class="anchor" aria-label="anchor" href="#simulations"></a>
</h3>
<p>The default option is to run a <code>TROLL</code> simulation using the <code>troll</code> function of the rcontroll package, which currently calls version 3.1.7 of <code>TROLL</code> using the Rcpp package (Eddelbuettel &amp; François 2011). The output is stored in a <code>trollsim</code> R class. For multiple runs, users can rely on the <code>stack</code> function, and the output is stored in the <code>trollstack</code> class. Both <code>trollsim</code> and <code>trollstack</code> values can be accessed using object attributes in the form of simple R objects (with <code>@</code> in R). They consist of eight simulation attributes: (1) name, (2) path to saved files, (3) parameters, (4) inputs, (5) log, (6) initial and final state, (7) ecosystem output metrics, and (8) species output metrics. The initial and final states are represented by a table with the spatial position, size and other relevant traits of all trees at the start and end of the simulation. The ecosystem and species metrics are summaries of ecosystem processes and states, such as net primary production and aboveground biomass, and they are documented at species level and aggregated over the entire stand. Simulations can be saved using a user-defined path when run and later loaded as a simple simulation (<code>load_output</code> function) or a stack of simulations (<code>load_stack</code> function).</p>
</div>
<div class="section level3">
<h3 id="simulated-airborne-lidar-scanning-option">Simulated airborne lidar scanning option<a class="anchor" aria-label="anchor" href="#simulated-airborne-lidar-scanning-option"></a>
</h3>
<p><code>TROLL</code> also has the capacity of generating point clouds from virtual aerial lidar scannings of simulated forest scenes. Within each cubic metre voxel of the simulated stand, points are generated probabilistically, with the probability depending both on the amount of light reaching the particular voxel and the amount of leaf matter intercepting light within the voxel. Extinction and interception of light are based on the Beer-Lambert law, but an effective extinction factor is used to account for differences between the near-infrared and visible light. The definition of the lidar parameters (<code>generate_lidar</code> function) is optional but allows the user to add a virtual aerial lidar scan for a time step of the <code>TROLL</code> simulation. When this option is enabled, the cloud of points from simulated aerial lidar scans are stored as LAS using the R package <code>lidR</code> (Roussel et al., 2020) as a ninth attribute of the <code>trollsim</code> and <code>trollstack</code> objects.</p>
</div>
<div class="section level3">
<h3 id="manipulation-of-simulation-outputs">Manipulation of simulation outputs<a class="anchor" aria-label="anchor" href="#manipulation-of-simulation-outputs"></a>
</h3>
<p><code>rcontroll</code> includes functions to manipulate simulation outputs. Simulation outputs can be retrieved directly from the <code>trollsim</code> or <code>trollstack</code>objects and summarised or plotted in the R environment with the <code>print</code>, <code>summary</code> and <code>autoplot</code> functions. The <code>get_chm</code> function allows users to retrieve canopy height models from aerial lidar point clouds (Fig. 2). In addition, a <code>rcontroll</code> function is available to visualise TROLL simulations as an animated figure (<code>autogif</code> function, Fig. 1).</p>
<div class="float">
<img src="https://raw.githubusercontent.com/sylvainschmitt/rcontroll/main/inst/figures/troll.gif" alt="Figure 1: Output from a TROLL simulation using the autogif function in the rcontroll package. The image shows a vertical cut in the forest structure along the X-axis (in metre) with individual tree height (metre) on the Y-axis. The tree colours indicate the identity of the species and can be changed using the ggplot2 grammar. The figure shows the forest structure dynamically over 200 years of a successional trajectory starting from bare ground."><div class="figcaption"><em>Figure 1: Output from a TROLL simulation using the autogif function in the rcontroll package. The image shows a vertical cut in the forest structure along the X-axis (in metre) with individual tree height (metre) on the Y-axis. The tree colours indicate the identity of the species and can be changed using the ggplot2 grammar. The figure shows the forest structure dynamically over 200 years of a successional trajectory starting from bare ground.</em></div>
</div>
<div class="float">
<img src="https://raw.githubusercontent.com/sylvainschmitt/rcontroll/main/inst/figures/lidar.png" alt="Figure 2: Cloud of points obtained through a virtual airborne lidar scan of a forest scene simulated with TROLL. The horizontal axes represent the X-axis and Y-axis (in metres) and the vertical axis represents height (in metres). The thermal colour scale indicates the height of the points in the cloud, from 0 m in dark blue to 40 m in red."><div class="figcaption"><em>Figure 2: Cloud of points obtained through a virtual airborne lidar scan of a forest scene simulated with TROLL. The horizontal axes represent the X-axis and Y-axis (in metres) and the vertical axis represents height (in metres). The thermal colour scale indicates the height of the points in the cloud, from 0 m in dark blue to 40 m in red.</em></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the latest version of <strong>rcontroll</strong> from Github using the <a href="https://github.com/r-lib/devtools" class="external-link"><code>devtools</code></a> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"devtools"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"sylvainschmitt/rcontroll"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sylvainschmitt/rcontroll" class="external-link">rcontroll</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"TROLLv3_species"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"TROLLv3_climatedaytime12"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"TROLLv3_daytimevar"</span><span class="op">)</span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/troll.html">troll</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"test"</span>,</span>
<span>             global <span class="op">=</span> <span class="fu"><a href="reference/generate_parameters.html">generate_parameters</a></span><span class="op">(</span>iterperyear <span class="op">=</span> <span class="fl">12</span>, nbiter <span class="op">=</span> <span class="fl">12</span><span class="op">*</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>             species <span class="op">=</span> <span class="va">TROLLv3_species</span>,</span>
<span>             climate <span class="op">=</span> <span class="va">TROLLv3_climatedaytime12</span>,</span>
<span>             daily <span class="op">=</span> <span class="va">TROLLv3_daytimevar</span><span class="op">)</span></span>
<span><span class="fu">autoplot</span><span class="op">(</span><span class="va">sim</span>, what <span class="op">=</span> <span class="st">"species"</span>, </span>
<span>         species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cecropia_obtusa"</span>,<span class="st">"Dicorynia_guianensis"</span>,</span>
<span>                     <span class="st">"Eperua_grandiflora"</span>,<span class="st">"Vouacapoua_americana"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=rcontroll" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/sylvainschmitt/rcontroll/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/sylvainschmitt/rcontroll/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing rcontroll</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Sylvain Schmitt <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-7759-7106" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Guillaume Salzet <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-4548-5673" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Fabian Fischer <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-2325-9886" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Isabelle Maréchaux <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-5401-0197" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Jérôme Chave <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-7766-1347" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Sylvain Schmitt, Guillaume Salzet, Fabian Fischer, Isabelle Maréchaux, Jérôme Chave.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
