<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The TROLL model • rcontroll</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The TROLL model">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rcontroll</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/climate.html">Generate climate data</a>
    </li>
    <li>
      <a href="../articles/lidar.html">Lidar simulation using TROLL</a>
    </li>
    <li>
      <a href="../articles/troll.html">The TROLL model</a>
    </li>
    <li>
      <a href="../articles/workflow.html">A simple workflow</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sylvainschmitt/rcontroll/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The TROLL model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sylvainschmitt/rcontroll/blob/main/vignettes/troll.Rmd" class="external-link"><code>vignettes/troll.Rmd</code></a></small>
      <div class="hidden name"><code>troll.Rmd</code></div>

    </div>

    
    
<p>TROLL models each tree individually in a located environment. Thus
TROLL model, alongside with SORTIE (Pacala et al. 1996; Uriarte et
al. 2009) and FORMIND (Köhler &amp; Huth 1998; Fischer et al. 2016), can
be defined as an individual-based and spatially explicit forest growth
model. TROLL simulates the life cycle of individual trees from
recruitment, with a diameter at breast height (dbh) above 1 cm, to death
with growth and seed production. Trees are growing in a spatialized
light environment explicitly computed within voxels of 1
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>m</mi><mn>3</mn></msup><annotation encoding="application/x-tex">m^3</annotation></semantics></math>.
Each tree is consistently defined by its age, diameter at breast height
(dbh), height (h), crown radius (CR), crown depth (CD) and leaf area
(LA). Tree geometry is calculated with allometric equations but leaf
area vary dynamically within each crown following carbon allocations.
Voxels resolution of 1
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>m</mi><mn>3</mn></msup><annotation encoding="application/x-tex">m^3</annotation></semantics></math>
allow the establishment of a maximum one tree by 1x1 m pixels. Each tree
is flagged with a species label inherited from the parent tree through
the seedling recruitment. A species label is associated with a number of
species specific parameters (see table below) related to functional
trait values which can be sampled on the field.</p>
<p>Carbon assimilation is computed over a half-hourly period of a
representative day. Then allocation is computed to simulate tree growth
from an explicit carbon balance (in contrast to previous models).
Finally the environment is updated at each timestep set to one month.
Seedlings are not simulated explicitly but as a pool. In addition
belowground processes, herbaceous plants, epiphytes and lianas are not
simulated inside TROLL.</p>
<table class="table">
<caption>Species-specific parameters used in TROLL from Maréchaux &amp;
Chave (2017). Data originates from the BRIDGE (Baraloto et al. 2010) and
TRY (Kattge et al. 2011) datasets.</caption>
<thead><tr class="header">
<th align="left">Abbreviation</th>
<th align="left">Description</th>
<th align="left">Units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>M</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">LMA</annotation></semantics></math></td>
<td align="left">leaf mass per area</td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>.</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">g.m^{-2}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mi>m</mi></msub><annotation encoding="application/x-tex">N_m</annotation></semantics></math></td>
<td align="left">leaf nitrogen content per dry mass</td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>g</mi><mi>.</mi><msup><mi>g</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">mg.g^{-1}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mi>m</mi></msub><annotation encoding="application/x-tex">P_m</annotation></semantics></math></td>
<td align="left">leaf phosphorus content per dry mass</td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>g</mi><mi>.</mi><msup><mi>g</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">mg.g^{-1}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mi>s</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">wsg</annotation></semantics></math></td>
<td align="left">wood specific gravity</td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>.</mi><mi>c</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">g.cm^{-3}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>b</mi><msub><mi>h</mi><mrow><mi>t</mi><mi>h</mi><mi>r</mi><mi>e</mi><mi>s</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">dbh_{thresh}</annotation></semantics></math></td>
<td align="left">diameter at breast height threshold</td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math></td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mrow><mi>l</mi><mi>i</mi><mi>m</mi></mrow></msub><annotation encoding="application/x-tex">h_{lim}</annotation></semantics></math></td>
<td align="left">asymptotic height</td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>h</mi></msub><annotation encoding="application/x-tex">a_h</annotation></semantics></math></td>
<td align="left">parameter of the tree-height-dbh allometry</td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="abiotic-environment">Abiotic environment<a class="anchor" aria-label="anchor" href="#abiotic-environment"></a>
</h3>
<p>A voxel space, with a resolution of 1
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>m</mi><mn>3</mn></msup><annotation encoding="application/x-tex">m^3</annotation></semantics></math>,
is used to explicitly model the abiotic environment. For each tree
crown, leaf area density is calculated on tree geometry assuming a
uniform distribution across voxels occupied by the crown. Leaf area
density is computed within each voxel summing all tree crowns inside the
voxel
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math>,
and is denoted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>A</mi><mi>D</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">LAD(v)</annotation></semantics></math>
(leaf area per voxel in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>²</mi><mi>.</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">m².m^{-3}</annotation></semantics></math>).
The vertical sum of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>A</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">LAD</annotation></semantics></math>
from voxel
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math>
to the ground level defines
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>A</mi><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">LAI(v)</annotation></semantics></math>
(leaf area per ground area in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>m</mi><mn>2</mn></msup><mi>.</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">m^2.m^{-2}</annotation></semantics></math>
commonly called leaf area index):</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>A</mi><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>v</mi><mi>′</mi><mo>=</mo><mi>v</mi></mrow><mi>∞</mi></msubsup><mi>L</mi><mi>A</mi><mi>D</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mi>′</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">LAI(v) = \sum _{v'=v} ^\infty LAD(v')</annotation></semantics></math></p>
<p>Daily variations in light intensity (photosynthetic photon flux
density PPFD in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mi>m</mi><mi>o</mi><msub><mi>l</mi><mrow><mi>p</mi><mi>h</mi><mi>o</mi><mi>t</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow></msub><mi>.</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup><mi>.</mi><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mu mol_{photons}.m^{-2}.s^{-1}</annotation></semantics></math>),
temperature (T in degrees Celsius), and vapour pressure deficit (VPD in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>P</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">kPA</annotation></semantics></math>)
are computed to assess carbon assimilation within each voxel of the
canopy and for a representative day per month (see Appendix 1 from <span class="citation">@Li</span> for further details). Variation of PPFD
Within the canopy is calculated as a local Beer-Lambert extinction
law:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>P</mi><mi>F</mi><msub><mi>D</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mo>,</mo><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>h</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mi>P</mi><mi>F</mi><msub><mi>D</mi><mrow><mi>t</mi><mi>o</mi><mi>p</mi><mo>,</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo>,</mo><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>h</mi></mrow></msub><mo>*</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>k</mi><mo>*</mo><mi>L</mi><mi>A</mi><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup></mrow><annotation encoding="application/x-tex">PPFD_{max,month}(v) = PPFD_{top,max,month}*e^{-k*LAI(v)}</annotation></semantics></math></p>
<p>The daily maximum incident PPFD at the top of canopy
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>P</mi><mi>F</mi><msub><mi>D</mi><mrow><mi>t</mi><mi>o</mi><mi>p</mi><mo>,</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo>,</mo><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">PPFD_{top,max,month}</annotation></semantics></math>
is given as input. The extinction rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
is assumed as constant, besides its variation with zenith angle and
species leaf inclination angle (Meir, 2000). Moreover only vertical
light diffusion is considered ignoring lateral light diffusion, which
can have an important role especially in logging gaps. Finally,
intra-day variation at half hour time steps
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
for a representative day every month are used to compute
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>P</mi><mi>F</mi><msub><mi>D</mi><mrow><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>h</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">PPFD_{month}(v,t)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>h</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">T_{month}(v,t)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>P</mi><msub><mi>D</mi><mrow><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>h</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">VPD_{month}(v,t)</annotation></semantics></math>.
Water and nutrient processes both in soil and inside trees are not
simulated.</p>
</div>
<div class="section level3">
<h3 id="photosynthesis">Photosynthesis<a class="anchor" aria-label="anchor" href="#photosynthesis"></a>
</h3>
<div class="section level4">
<h4 id="theory">Theory<a class="anchor" aria-label="anchor" href="#theory"></a>
</h4>
<p>Troll simulates the carbon uptake of each individual with the
Farquhar, von Caemmerer and Berry model of C3 photosynthesis (Farquhar
et al. 1980). Gross carbon assimilation rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mi>m</mi><mi>o</mi><mi>l</mi><mspace width="0.222em"></mspace><mi>C</mi><msub><mi>O</mi><mn>2</mn></msub><mi>.</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup><mi>.</mi><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mu mol~CO_2. m^{-2}.s^{-1}</annotation></semantics></math>)
will be the minimum of either Rubisco activity
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>v</mi></msub><annotation encoding="application/x-tex">A_v</annotation></semantics></math>)
or RuBP generation
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>j</mi></msub><annotation encoding="application/x-tex">A_j</annotation></semantics></math>):</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mi>v</mi></msub><mo>,</mo><msub><mi>A</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.222em"></mspace><msub><mi>A</mi><mi>v</mi></msub><mo>=</mo><msub><mi>V</mi><mrow><mi>c</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>*</mo><mfrac><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>−</mo><msup><mi>Γ</mi><mo>*</mo></msup></mrow><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>+</mo><msub><mi>K</mi><mi>m</mi></msub></mrow></mfrac><mspace width="0.222em"></mspace><mo>;</mo><mspace width="0.222em"></mspace><msub><mi>A</mi><mi>j</mi></msub><mo>=</mo><mfrac><mi>J</mi><mn>4</mn></mfrac><mo>*</mo><mfrac><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>−</mo><msup><mi>Γ</mi><mo>*</mo></msup></mrow><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>+</mo><mn>2</mn><mo>*</mo><msup><mi>Γ</mi><mo>*</mo></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">A=min(A_v, A_j)~|~A_v=V_{cmax}*\frac{c_i-\Gamma^*}{c_i+K_m}~;~A_j=\frac{J}{4}*\frac{c_i-\Gamma^*}{c_i+2*\Gamma^*}</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>c</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{cmax}</annotation></semantics></math>
is the maximum rate of carboxylation
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mi>m</mi><mi>o</mi><mi>l</mi><mspace width="0.222em"></mspace><mi>C</mi><msub><mi>O</mi><mn>2</mn></msub><mi>.</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup><mi>.</mi><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mu mol~CO_2.m^{-2}.s^{-1}</annotation></semantics></math>).
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>i</mi></msub><annotation encoding="application/x-tex">c_i</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><msub><mi>O</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">CO_2</annotation></semantics></math>
partial pressure at carboxylation sites.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Γ</mi><mo>*</mo></msup><annotation encoding="application/x-tex">\Gamma^*</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><msub><mi>O</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">CO_2</annotation></semantics></math>
compensation point in absence of dark respiration.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>m</mi></msub><annotation encoding="application/x-tex">K_m</annotation></semantics></math>
is the apparent kinetic constant of the Rubisco. And
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
is the electron transport rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mi>m</mi><mi>o</mi><mi>l</mi><msup><mi>e</mi><mo>−</mo></msup><mi>.</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup><mi>.</mi><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mu mol e^-.m^{-2}.s^{-1}</annotation></semantics></math>).
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
depends on the light intensity with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>P</mi><mi>F</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">PPFD</annotation></semantics></math>:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mo>*</mo><mi>θ</mi></mrow></mfrac><mo>*</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>α</mi><mo>*</mo><mi>P</mi><mi>P</mi><mi>F</mi><mi>D</mi><mo>+</mo><msub><mi>J</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>−</mo><msqrt><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>*</mo><mi>P</mi><mi>P</mi><mi>F</mi><mi>D</mi><mo>+</mo><msub><mi>J</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></msqrt><mo>−</mo><mn>4</mn><mo>*</mo><mi>θ</mi><mo>*</mo><mi>α</mi><mo>*</mo><mi>P</mi><mi>P</mi><mi>F</mi><mi>D</mi><mo>*</mo><msub><mi>J</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">J = \frac{1}{2*\theta}*[\alpha*PPFD+J_{max}-\sqrt{(\alpha*PPFD+J_{max})^2}-4*\theta*\alpha*PPFD*J_{max}]</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>J</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">J_{max}</annotation></semantics></math>
is the maximal electron transport capacity
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mi>m</mi><mi>o</mi><mi>l</mi><msup><mi>e</mi><mo>−</mo></msup><mi>.</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup><mi>.</mi><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mu mol e^-.m^{-2}.s^{-1}</annotation></semantics></math>).
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
is the curvature factor. And
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
is the apparent quantum yield to electron transport
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>o</mi><mi>l</mi><msup><mi>e</mi><mo>−</mo></msup><mi>.</mi><mi>m</mi><mi>o</mi><mi>l</mi><mspace width="0.222em"></mspace><mi>p</mi><mi>h</mi><mi>o</mi><mi>t</mi><mi>o</mi><mi>n</mi><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">mole^-.mol~photons^{-1}</annotation></semantics></math>).</p>
<p>Carbon assimilation by photosynthesis will then be limited by the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><msub><mi>O</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">CO_2</annotation></semantics></math>
partial pressure at carboxylation sites. Stomata controls the gas
concentration at carboxylation sites through stomatal transport:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msub><mi>g</mi><mi>s</mi></msub><mo>*</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>a</mi></msub><mo>−</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">A = g_s*(c_a-c_i)</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mi>s</mi></msub><annotation encoding="application/x-tex">g_s</annotation></semantics></math>
is the stomatal conductance to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><msub><mi>O</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">CO_2</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>o</mi><mi>l</mi><mi>C</mi><msub><mi>O</mi><mn>2</mn></msub><mi>.</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup><mi>.</mi><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">molCO_2.m^{-2}.s^{-1}</annotation></semantics></math>).
TROLL simulates stomatal conductance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mi>s</mi></msub><annotation encoding="application/x-tex">g_s</annotation></semantics></math>
with the model from (Medlyn et al. 2011):</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>s</mi></msub><mo>=</mo><msub><mi>g</mi><mn>0</mn></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mfrac><msub><mi>g</mi><mn>1</mn></msub><msqrt><mrow><mi>V</mi><mi>P</mi><mi>D</mi></mrow></msqrt></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>*</mo><mfrac><mi>A</mi><msub><mi>c</mi><mi>a</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">g_s = g_0 + (1 + \frac{g_1}{\sqrt{VPD}})*\frac{A}{c_a}</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mn>0</mn></msub><annotation encoding="application/x-tex">g_0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mn>1</mn></msub><annotation encoding="application/x-tex">g_1</annotation></semantics></math>
are parameters from the model. TROLL model assume
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mn>0</mn></msub><mo>≈</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">g_0 \approx 0</annotation></semantics></math>
(empirically tested and considered as reasonable).</p>
</div>
<div class="section level4">
<h4 id="parametrization">Parametrization<a class="anchor" aria-label="anchor" href="#parametrization"></a>
</h4>
<p>Leaf traits can be used as a proxy of photosynthesis, especially leaf
nutrient content which directly plays a role in it (Wright et al. 2004).
Domingues et al. (2010) suggested that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>c</mi><mi>m</mi><mi>a</mi><mi>c</mi></mrow></msub><annotation encoding="application/x-tex">V_{cmac}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>J</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">J_{max}</annotation></semantics></math>
were both limited by the leaf concentration of nitrogen
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
and phosphorus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>g</mi><mi>.</mi><msup><mi>g</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">mg.g^{-1}</annotation></semantics></math>):</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>10</mn></msub><msub><mi>V</mi><mrow><mi>c</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo>−</mo><mi>M</mi></mrow></msub><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mo>−</mo><mn>1.56</mn><mo>+</mo><mn>0.43</mn><mo>*</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>10</mn></msub><mi>N</mi><mo>−</mo><mn>0.37</mn><mo>*</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>10</mn></msub><mi>L</mi><mi>M</mi><mi>A</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mo>−</mo><mn>0.80</mn><mo>+</mo><mn>0.45</mn><mo>*</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>10</mn></msub><mi>P</mi><mo>−</mo><mn>0.25</mn><mo>*</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>10</mn></msub><mi>L</mi><mi>M</mi><mi>A</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">log_{10} V_{cmax-M} = min(\begin{array}{c} -1.56+0.43*log_{10} N-0.37*log_{10} LMA \\ -0.80+0.45*log_{10} P-0.25*log_{10} LMA \end{array})</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>10</mn></msub><msub><mi>J</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mo>−</mo><mi>M</mi></mrow></msub><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mo>−</mo><mn>1.50</mn><mo>+</mo><mn>0.41</mn><mo>*</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>10</mn></msub><mi>N</mi><mo>−</mo><mn>0.45</mn><mo>*</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>10</mn></msub><mi>L</mi><mi>M</mi><mi>A</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mo>−</mo><mn>0.74</mn><mo>+</mo><mn>0.44</mn><mo>*</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>10</mn></msub><mi>P</mi><mo>−</mo><mn>0.32</mn><mo>*</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>10</mn></msub><mi>L</mi><mi>M</mi><mi>A</mi></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">log_{10} J_{max-M} = min(\begin{array}{c} -1.50+0.41*log_{10} N-0.45*log_{10} LMA \\ -0.74+0.44*log_{10} P-0.32*log_{10} LMA \end{array}</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>c</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo>−</mo><mi>M</mi></mrow></msub><annotation encoding="application/x-tex">V_{cmax-M}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>J</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mo>−</mo><mi>M</mi></mrow></msub><annotation encoding="application/x-tex">J_{max-M}</annotation></semantics></math>
are the photosynthetic capacities at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>25</mn><mo>∘</mo></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">25^\circ C</annotation></semantics></math>
of mature leaves per leaf dry mass (resp.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mi>m</mi><mi>o</mi><mi>l</mi><mi>C</mi><msub><mi>O</mi><mn>2</mn></msub><mi>.</mi><msup><mi>g</mi><mo>−</mo></msup><mn>1</mn><mi>.</mi><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mu mol CO_2.g^-1.s^{-1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mi>m</mi><mi>o</mi><mi>l</mi><msup><mi>e</mi><mo>−</mo></msup><mi>.</mi><msup><mi>g</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>.</mi><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mu mol e^-.g^{-1}.s^{-1}</annotation></semantics></math>).
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>M</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">LMA</annotation></semantics></math>
is the leaf mass per are
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>.</mi><mi>c</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">g.cm^{-2}</annotation></semantics></math>).
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>c</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{cmax}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>J</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">J_{max}</annotation></semantics></math>
are calculated by multiplying
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>c</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo>−</mo><mi>M</mi></mrow></msub><annotation encoding="application/x-tex">V_{cmax-M}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>J</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mo>−</mo><mi>M</mi></mrow></msub><annotation encoding="application/x-tex">J_{max-M}</annotation></semantics></math>
by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>M</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">LMA</annotation></semantics></math>.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>c</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{cmax}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>J</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">J_{max}</annotation></semantics></math>
variations with temperature are calculated with Bernacchi et
al. (2003).</p>
<p>TROLL computes leaf carbon assimilation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>l</mi></msub><annotation encoding="application/x-tex">A_l</annotation></semantics></math>
combining equations from for each tree crown voxel within in each crown
layer
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>l</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><msub><mi>n</mi><mi>v</mi></msub><mo>*</mo><msub><mi>t</mi><mi>M</mi></msub></mrow></mfrac><mo>*</mo><msub><mo>∑</mo><mi>v</mi></msub><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>t</mi><mi>M</mi></msub></msubsup><mi>A</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mi>P</mi><mi>F</mi><msub><mi>D</mi><mrow><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>h</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>V</mi><mi>P</mi><msub><mi>D</mi><mrow><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>h</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msub><mi>T</mi><mrow><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>h</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">A_l = \frac{1}{n_v*t_M} * \sum_v  \sum^{t_M}_{t=1} A(PPFD_{month}(v,t),VPD_{month}(v,t),T_{month}(v,t))</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>P</mi><mi>F</mi><msub><mi>D</mi><mrow><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>h</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">PPFD_{month}(v,t)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>P</mi><msub><mi>D</mi><mrow><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>h</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">VPD_{month}(v,t)</annotation></semantics></math>
, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>h</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">T_{month}(v,t)</annotation></semantics></math>
are derived from microclimatic data.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>v</mi></msub><annotation encoding="application/x-tex">n_v</annotation></semantics></math>
is the number of voxels within crown layer
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>.
And the sum is calculated over the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>M</mi></msub><annotation encoding="application/x-tex">t_M</annotation></semantics></math>
half-hourly intervals
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
of a typical day.</p>
</div>
</div>
<div class="section level3">
<h3 id="autotrophic-respiration">Autotrophic respiration<a class="anchor" aria-label="anchor" href="#autotrophic-respiration"></a>
</h3>
<p>A large fraction of plants carbon uptake is actually used for plant
maintenance and growth respiration. The autotrophic respiration can
represent up to 65% of the gross primary productivity but varies
strongly among species, sites, and environments.</p>
<p>TROLL uses Atkin et al. (2015) database of mature leaf dark
respiration and associated leaf traits to compute leaf maintenance
respiration:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mrow><mi>l</mi><mi>e</mi><mi>a</mi><mi>f</mi><mo>−</mo><mi>M</mi></mrow></msub><mo>=</mo><mn>8.5431</mn><mo>−</mo><mn>0.1306</mn><mo>*</mo><mi>N</mi><mo>−</mo><mn>0.5670</mn><mo>*</mo><mi>P</mi><mo>−</mo><mn>0.0137</mn><mo>*</mo><mi>L</mi><mi>M</mi><mi>A</mi><mo>+</mo><mn>11.1</mn><mo>*</mo><msub><mi>V</mi><mrow><mi>c</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo>−</mo><mi>M</mi></mrow></msub><mo>+</mo><mn>0.1876</mn><mo>*</mo><mi>N</mi><mo>*</mo><mi>P</mi></mrow><annotation encoding="application/x-tex">R_{leaf-M} = 8.5431-0.1306*N-0.5670*P-0.0137*LMA+11.1*V_{cmax-M}+0.1876*N*P</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mrow><mi>l</mi><mi>e</mi><mi>a</mi><mi>f</mi><mo>−</mo><mi>M</mi></mrow></msub><annotation encoding="application/x-tex">R_{leaf-M}</annotation></semantics></math>
is the dark respiration rate per leaf dry mass at a temperature of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>25</mn><mo>∘</mo></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">25^\circ C</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>m</mi><mi>o</mi><mi>l</mi><mi>C</mi><msub><mi>O</mi><mn>2</mn></msub><mi>.</mi><msup><mi>g</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>.</mi><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">nmolCO_2.g^{-1}.s^{-1}</annotation></semantics></math>).
TROLL assumes leaf respiration during daylight to be 40% of leaf dark
respiration, and computes total leaf respiration by accounting for the
length of daylight.</p>
<p>TROLL model stem respiration
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mrow><mi>s</mi><mi>t</mi><mi>e</mi><mi>m</mi></mrow></msub><annotation encoding="application/x-tex">R_{stem}</annotation></semantics></math>
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mi>m</mi><mi>o</mi><mi>l</mi><mi>C</mi><mi>.</mi><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mu molC.s^{-1}</annotation></semantics></math>)
with a constant respiration rate per volume of sapwood:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mrow><mi>s</mi><mi>t</mi><mi>e</mi><mi>m</mi></mrow></msub><mo>=</mo><mn>39.6</mn><mo>*</mo><mi>π</mi><mo>*</mo><mi>S</mi><mi>T</mi><mo>*</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mi>b</mi><mi>h</mi><mo>−</mo><mi>S</mi><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>*</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo>−</mo><mi>C</mi><mi>D</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">R_{stem} = 39.6*\pi*ST*(dbh-ST)*(h-CD)</annotation></semantics></math></p>
<p>dbh, h, CD and ST are tree diameter at breast height, height, crown
depth and sapwood thickness, respectively
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>).
TROLL assumes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>T</mi><mo>=</mo><mn>0.04</mn><mspace width="0.222em"></mspace><mi>m</mi></mrow><annotation encoding="application/x-tex">ST=0.04~m</annotation></semantics></math>
when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>b</mi><mi>h</mi><mo>&gt;</mo><mn>30</mn><mspace width="0.222em"></mspace><mi>c</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">dbh&gt;30~cm</annotation></semantics></math>
and an increasing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">ST</annotation></semantics></math>
for lower
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>b</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">dbh</annotation></semantics></math>.</p>
<p>Finally, TROLL computes both fine root maintenance respiration, as
half of the leaf maintenance respiration. Whereas coarse root and branch
maintenance respiration is computed as half of the stem respiration. And
growth respiration
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mrow><mi>g</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>t</mi><mi>h</mi></mrow></msub><annotation encoding="application/x-tex">R_{growth}</annotation></semantics></math>)
is assumed to account for 25% of the gross primary productivity minus
the sum of maintenance respiration.</p>
</div>
<div class="section level3">
<h3 id="net-carbon-uptake">Net carbon uptake<a class="anchor" aria-label="anchor" href="#net-carbon-uptake"></a>
</h3>
<p>Net primary production of carbon for one individual
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>P</mi><msub><mi>P</mi><mrow><mi>i</mi><mi>n</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">NPP_{ind}</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">gC</annotation></semantics></math>)
is computed by the balance between gross primary production
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>P</mi><msub><mi>P</mi><mrow><mi>i</mi><mi>n</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">GPP_{ind}</annotation></semantics></math>
and respiration
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>P</mi><msub><mi>P</mi><mrow><mi>i</mi><mi>n</mi><mi>d</mi></mrow></msub><mo>=</mo><mi>G</mi><mi>P</mi><msub><mi>P</mi><mrow><mi>i</mi><mi>n</mi><mi>d</mi></mrow></msub><mo>−</mo><msub><mi>R</mi><mrow><mi>m</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi></mrow></msub><mo>−</mo><msub><mi>R</mi><mrow><mi>g</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>t</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">NPP_{ind} = GPP_{ind} - R_{maintenance} - R_{growth}</annotation></semantics></math></p>
<p>TROLL partitions individuals’ total leaf area
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">LA</annotation></semantics></math>
into three pools for different leaf age classes corresponding to
different photosynthesis efficiency (young, mature and old leaves with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><msub><mi>A</mi><mrow><mi>y</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">LA_{young}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><msub><mi>A</mi><mrow><mi>m</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow></msub></mrow><annotation encoding="application/x-tex">LA_{mature}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><msub><mi>A</mi><mrow><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">LA_{old}</annotation></semantics></math>
respectively). Consequently we can compute growth primary production for
one individual as:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>P</mi><msub><mi>P</mi><mrow><mi>i</mi><mi>n</mi><mi>d</mi></mrow></msub><mo>=</mo><mn>189.3</mn><mo>*</mo><mi>Δ</mi><mi>t</mi><mo>*</mo><msubsup><mo>∑</mo><mrow><mi>l</mi><mo>=</mo><mo stretchy="false" form="prefix">⌊</mo><mi>h</mi><mo>−</mo><mi>C</mi><mi>D</mi><mo stretchy="false" form="postfix">⌋</mo><mo>+</mo><mn>1</mn></mrow><mrow><mo stretchy="false" form="prefix">⌊</mo><mi>h</mi><mo stretchy="false" form="postfix">⌋</mo></mrow></msubsup><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>A</mi><mi>l</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>*</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>L</mi><msub><mi>A</mi><mrow><mi>y</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>g</mi></mrow></msub></mrow><mn>2</mn></mfrac><mo>+</mo><mi>L</mi><msub><mi>A</mi><mrow><mi>m</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow></msub><mo>+</mo><mfrac><mrow><mi>L</mi><msub><mi>A</mi><mrow><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub></mrow><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">GPP_{ind} = 189.3 * \Delta t * \sum _{l= \lfloor h-CD \rfloor +1} ^{\lfloor h \rfloor} [A_l] * (\frac{LA_{young}}{2} + LA_{mature} + \frac{LA_{old}}{2})</annotation></semantics></math></p>
<p>h and CD are tree height and crown depth, respectively
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>).
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">⌊</mo><mi>x</mi><mo stretchy="false" form="postfix">⌋</mo></mrow><annotation encoding="application/x-tex">\lfloor x \rfloor</annotation></semantics></math>
is the rounding function.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\Delta t</annotation></semantics></math>
is the duration of a timestep
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">year</annotation></semantics></math>).</p>
<p>Thus, TROLL can compute carbon allocation to wood into an increment
of stem volume
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">\Delta V</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>m</mi><mn>3</mn></msup><annotation encoding="application/x-tex">m^3</annotation></semantics></math>):</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mi>V</mi><mo>=</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>6</mn></mrow></msup><mo>*</mo><mfrac><mrow><msub><mi>f</mi><mrow><mi>w</mi><mi>o</mi><mi>o</mi><mi>d</mi></mrow></msub><mo>*</mo><mi>N</mi><mi>P</mi><msub><mi>P</mi><mrow><mi>i</mi><mi>n</mi><mi>d</mi></mrow></msub></mrow><mrow><mn>0.5</mn><mo>*</mo><mi>w</mi><mi>s</mi><mi>g</mi></mrow></mfrac><mo>*</mo><mi>S</mi><mi>e</mi><mi>n</mi><mi>e</mi><mi>s</mi><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mi>b</mi><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Delta V = 10^{-6} * \frac{f_{wood}*NPP_{ind}}{0.5*wsg}*Senesc(dbh)</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mrow><mi>w</mi><mi>o</mi><mi>o</mi><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">f_{wood}</annotation></semantics></math>
is the fixed fraction of NPP allocated to stem and branches.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mi>s</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">wsg</annotation></semantics></math>
is the wood specific gravity
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>.</mi><mi>c</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">g.cm^{-3}</annotation></semantics></math>,
see @ref(tab:traits)). TROLL assume large trees less efficient to
convert NPP as growth by using a size-related growth decline with
function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>e</mi><mi>n</mi><mi>e</mi><mi>s</mi><mi>c</mi></mrow><annotation encoding="application/x-tex">Senesc</annotation></semantics></math>
after a specific diameter at breast height threshold
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>b</mi><msub><mi>h</mi><mrow><mi>t</mi><mi>h</mi><mi>r</mi><mi>e</mi><mi>s</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">dbh_{thresh}</annotation></semantics></math>:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>e</mi><mi>n</mi><mi>e</mi><mi>s</mi><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mi>b</mi><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>;</mo><mn>3</mn><mo>−</mo><mn>2</mn><mo>*</mo><mfrac><mrow><mi>d</mi><mi>b</mi><mi>h</mi></mrow><mrow><mi>d</mi><mi>b</mi><msub><mi>h</mi><mrow><mi>t</mi><mi>h</mi><mi>r</mi><mi>e</mi><mi>s</mi><mi>h</mi></mrow></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Senesc(dbh) = max(0;3-2*\frac{dbh}{dbh_{thresh}})</annotation></semantics></math></p>
<p>Finally, TROLL can compute carbon allocation to canopy with canopy
NPP fraction denoted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mrow><mi>c</mi><mi>a</mi><mi>n</mi><mi>o</mi><mi>p</mi><mi>y</mi></mrow></msub><annotation encoding="application/x-tex">f_{canopy}</annotation></semantics></math>
and decomposed into leaf, twig and fruit production. Carbon allocation
to leaf results in a new young leaf pool, whereas other leaf pools are
updated as follow:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>Δ</mi><mi>L</mi><msub><mi>A</mi><mrow><mi>y</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>g</mi></mrow></msub><mo>=</mo><mfrac><mrow><mn>2</mn><mo>*</mo><msub><mi>f</mi><mrow><mi>l</mi><mi>e</mi><mi>a</mi><mi>v</mi><mi>e</mi><mi>s</mi></mrow></msub><mo>*</mo><mi>N</mi><mi>P</mi><msub><mi>P</mi><mrow><mi>i</mi><mi>n</mi><mi>d</mi></mrow></msub></mrow><mrow><mi>L</mi><mi>M</mi><mi>A</mi></mrow></mfrac><mo>−</mo><mfrac><mrow><mi>L</mi><msub><mi>A</mi><mrow><mi>y</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>g</mi></mrow></msub></mrow><msub><mi>τ</mi><mrow><mi>y</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>g</mi></mrow></msub></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>Δ</mi><mi>L</mi><msub><mi>A</mi><mrow><mi>m</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>L</mi><msub><mi>A</mi><mrow><mi>y</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>g</mi></mrow></msub></mrow><msub><mi>τ</mi><mrow><mi>y</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>g</mi></mrow></msub></mfrac><mo>−</mo><mfrac><mrow><mi>L</mi><msub><mi>A</mi><mrow><mi>m</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow></msub></mrow><msub><mi>τ</mi><mrow><mi>m</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow></msub></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>Δ</mi><mi>L</mi><msub><mi>A</mi><mrow><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>L</mi><msub><mi>A</mi><mrow><mi>m</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow></msub></mrow><msub><mi>τ</mi><mrow><mi>m</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow></msub></mfrac><mo>−</mo><mfrac><mrow><mi>L</mi><msub><mi>A</mi><mrow><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub></mrow><msub><mi>τ</mi><mrow><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub></mfrac></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{c} \\ \Delta LA_{young} = \frac{2*f_{leaves}*NPP_{ind}}{LMA}-\frac{LA_{young}}{\tau_{young}} \\ \Delta LA_{mature} = \frac{LA_{young}}{\tau_{young}} - \frac{LA_{mature}}{\tau_{mature}}\\ \Delta LA_{old} = \frac{LA_{mature}}{\tau_{mature}} - \frac{LA_{old}}{\tau_{old}} \end{array}</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>τ</mi><mrow><mi>y</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">\tau_{young}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>τ</mi><mrow><mi>m</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow></msub><annotation encoding="application/x-tex">\tau_{mature}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>τ</mi><mrow><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">\tau_{old}</annotation></semantics></math>
are species’ residence times in each leaf pool
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>e</mi><mi>a</mi><mi>r</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">years</annotation></semantics></math>).
The sum of residency time thus defined the leaf lifespan
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>L</mi><mo>=</mo><msub><mi>τ</mi><mrow><mi>y</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>g</mi></mrow></msub><mo>+</mo><msub><mi>τ</mi><mrow><mi>m</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow></msub><mo>+</mo><msub><mi>τ</mi><mrow><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">LL = \tau_{young} + \tau_{mature} + \tau_{old}</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>e</mi><mi>a</mi><mi>r</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">years</annotation></semantics></math>).
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>τ</mi><mrow><mi>y</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">\tau_{young}</annotation></semantics></math>
is set to one month and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>τ</mi><mrow><mi>m</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow></msub><annotation encoding="application/x-tex">\tau_{mature}</annotation></semantics></math>
is set to a third of leaf lifespan
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">LL</annotation></semantics></math>.
Belowground carbon allocation is not simulated inside TROLL.</p>
</div>
<div class="section level3">
<h3 id="tree-growth">Tree growth<a class="anchor" aria-label="anchor" href="#tree-growth"></a>
</h3>
<p>Once the increment of stem volume
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">\Delta V</annotation></semantics></math>
is calculated, TROLL converts it into an increment of tree diameter at
breast height denoted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mi>d</mi><mi>b</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">\Delta dbh</annotation></semantics></math>.
TROLL infer tree height from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>b</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">dbh</annotation></semantics></math>
using a Michaelis-Menten equation:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><msub><mi>h</mi><mrow><mi>l</mi><mi>i</mi><mi>m</mi></mrow></msub><mo>*</mo><mfrac><mrow><mi>d</mi><mi>b</mi><mi>h</mi></mrow><mrow><mi>d</mi><mi>b</mi><mi>h</mi><mo>+</mo><msub><mi>a</mi><mi>h</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">h = h_{lim}*\frac{dbh}{dbh + a_h}</annotation></semantics></math></p>
<p>On the other hand, we have the trunk volume
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>=</mo><mi>C</mi><mo>*</mo><mi>π</mi><mo>*</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>d</mi><mi>b</mi><mi>h</mi></mrow><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>*</mo><mi>h</mi></mrow><annotation encoding="application/x-tex">V = C * \pi * (\frac{dbh}{2})^2*h</annotation></semantics></math>,
thus:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>Δ</mi><mi>V</mi><mo>=</mo><mi>C</mi><mo>*</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>*</mo><mi>π</mi><mo>*</mo><mi>h</mi><mo>*</mo><mi>d</mi><mi>b</mi><mi>h</mi><mo>*</mo><mi>Δ</mi><mi>d</mi><mi>b</mi><mi>h</mi><mo>+</mo><mi>C</mi><mo>*</mo><mi>π</mi><mo>*</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>d</mi><mi>b</mi><mi>h</mi></mrow><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>*</mo><mi>h</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>Δ</mi><mi>V</mi><mo>=</mo><mi>V</mi><mo>*</mo><mfrac><mrow><mi>Δ</mi><mi>d</mi><mi>b</mi><mi>h</mi></mrow><mrow><mi>d</mi><mi>b</mi><mi>h</mi></mrow></mfrac><mo>*</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>3</mn><mo>−</mo><mfrac><mrow><mi>d</mi><mi>b</mi><mi>h</mi></mrow><mrow><mi>d</mi><mi>b</mi><mi>h</mi><mo>+</mo><mi>a</mi><mi>h</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{c} \\ \Delta V = C*\frac{1}{2}*\pi*h*dbh*\Delta dbh + C * \pi * (\frac{dbh}{2})^2*h \\ \Delta V = V*\frac{\Delta dbh}{dbh}*(3-\frac{dbh}{dbh + ah})\end{array}</annotation></semantics></math></p>
<p>Next, TROLL used the new trunk dimension
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>b</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">dbh</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>)
to update tree crown geometry using allometric equations (Chave et
al. 2005):</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>C</mi><mi>R</mi><mo>=</mo><mn>0.80</mn><mo>+</mo><mn>10.47</mn><mo>*</mo><mi>d</mi><mi>b</mi><mi>h</mi><mo>−</mo><mn>3.33</mn><mo>*</mo><mi>d</mi><mi>b</mi><msup><mi>h</mi><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>C</mi><mi>D</mi><mo>=</mo><mo>−</mo><mn>0.48</mn><mo>+</mo><mn>0.26</mn><mo>*</mo><mi>h</mi><mspace width="0.222em"></mspace><mo>;</mo><mspace width="0.222em"></mspace><mi>C</mi><mi>D</mi><mo>=</mo><mn>0.13</mn><mo>+</mo><mn>0.17</mn><mo>*</mo><mi>h</mi><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo>&lt;</mo><mn>5</mn><mspace width="0.222em"></mspace><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{c} \\ CR = 0.80 + 10.47*dbh - 3.33*dbh^2\\ CD = -0.48 + 0.26*h~;~CD = 0.13 + 0.17*h~(h&lt;5~m)\end{array}</annotation></semantics></math></p>
<p>Finally, TROLL computes the mean leaf density within the crown
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">LD</annotation></semantics></math>
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>m</mi><mn>2</mn></msup><mi>.</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">m^2.m^{-3}</annotation></semantics></math>)
assuming a uniform distribution:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>D</mi><mo>=</mo><mfrac><mrow><mi>L</mi><msub><mi>A</mi><mrow><mi>y</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>g</mi></mrow></msub><mo>+</mo><mi>L</mi><msub><mi>A</mi><mrow><mi>m</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow></msub><mo>+</mo><mi>L</mi><msub><mi>A</mi><mrow><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub></mrow><mrow><mi>π</mi><mo>*</mo><mi>C</mi><msup><mi>R</mi><mn>2</mn></msup><mo>*</mo><mi>C</mi><mi>D</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">LD = \frac{LA_{young}+LA_{mature}+LA_{old}}{\pi*CR^2*CD}</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="mortality">Mortality<a class="anchor" aria-label="anchor" href="#mortality"></a>
</h3>
<p>Mortality is partitioned in two factors inside TROLL: background
death
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>b</mi></msub><annotation encoding="application/x-tex">d_b</annotation></semantics></math>
and treefall death
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>t</mi></msub><annotation encoding="application/x-tex">d_t</annotation></semantics></math>.</p>
<p>Chave et al. (2009) advocated for a wood economics spectrum opposing
fast growing light wood species with high risk of mortality to slow
growing dense wood species with reduced risk of mortality. Hence,
background mortality is derived from wood specific gravity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mi>s</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">wsg</annotation></semantics></math>
inside TROLL:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>b</mi></msub><mo>=</mo><mi>m</mi><mo>*</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mfrac><mrow><mi>w</mi><mi>s</mi><mi>g</mi></mrow><mrow><mi>w</mi><mi>s</mi><msub><mi>g</mi><mrow><mi>l</mi><mi>i</mi><mi>m</mi></mrow></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>d</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">d_b = m*(1-\frac{wsg}{wsg_{lim}})+d_n</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>v</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi>.</mi><mi>y</mi><mi>e</mi><mi>a</mi><msup><mi>r</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">events.year^{-1}</annotation></semantics></math>)
is the reference background death rate for lighter wood species
(pioneers).
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>n</mi></msub><annotation encoding="application/x-tex">d_n</annotation></semantics></math>
represents death by carbohydrates shortage. If the number of consecutive
days with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>P</mi><msub><mi>P</mi><mrow><mi>i</mi><mi>n</mi><mi>d</mi></mrow></msub><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">NPP_{ind} &lt; 0</annotation></semantics></math>
is superior to tree leaf lifespan
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>n</mi></msub><annotation encoding="application/x-tex">d_n</annotation></semantics></math>
is set to 1 and remains null in other cases.</p>
<p>Mortality by treefall inside TROLL depends on a specific stochastic
threshold
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>=</mo><msub><mi>h</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>*</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>v</mi><mi>T</mi></msub><mo>*</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>ζ</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta = h_{max}*(1-v_T*|\zeta|)</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">h_{max}</annotation></semantics></math>
is the maximal tree height.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>v</mi><mi>T</mi></msub><annotation encoding="application/x-tex">v_T</annotation></semantics></math>
is the variance term set to 0.3.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">|</mo><mi>ζ</mi><mo stretchy="true" form="postfix">|</mo></mrow><annotation encoding="application/x-tex">|\zeta|</annotation></semantics></math>
is the absolute value of a random centred and scaled Gaussian. If the
tree height
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>
is superior to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
then the tree may fall with a probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>θ</mi><mi>/</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">1-\theta/h</annotation></semantics></math>
(Chave 1999). The treefall direction is random (drawn from a uniform law
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝒰</mi><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>2</mn><mi>π</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{U}[0,2\pi]</annotation></semantics></math>).
All trees in the trajectory of the falling tree will be hurted through a
variable denoted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>u</mi><mi>r</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">hurt</annotation></semantics></math>,
incremented by fallen tree height
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>.
If a tree height is inferior than its
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>u</mi><mi>r</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">hurt</annotation></semantics></math>
values then it may die with a probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mfrac><mi>h</mi><mrow><mi>h</mi><mi>u</mi><mi>r</mi><mi>t</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">1-\frac{1}{2}\frac{h}{hurt}</annotation></semantics></math>.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>u</mi><mi>r</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">hurt</annotation></semantics></math>
variable is reset to null at each timestep
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">month</annotation></semantics></math>).</p>
</div>
<div class="section level3">
<h3 id="recruitment">Recruitment<a class="anchor" aria-label="anchor" href="#recruitment"></a>
</h3>
<p>Once the tree becomes fertile they will start to disperse seeds.
TROLL consider tree as fertile after a specific height threshold
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mrow><mi>m</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow></msub><annotation encoding="application/x-tex">h_{mature}</annotation></semantics></math>
(Wright et al. 2005):</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mrow><mi>m</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow></msub><mo>=</mo><mo>−</mo><mn>11.47</mn><mo>+</mo><mn>0.90</mn><mo>*</mo><msub><mi>h</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">h_{mature} = -11.47+0.90*h_{max}</annotation></semantics></math></p>
<p>But TROLL is not considering seed directly through a seedbank,
instead seed might be interpreted as a seedling recruitment opportunity.
The number of reproduction opportunities per mature tree is denoted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>s</mi></msub><annotation encoding="application/x-tex">n_s</annotation></semantics></math>
and set to 10 for all species. This assumption originates from a
trade-off between seed number and seed size resulting in equivalent
survival and recruitment probability. All
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>s</mi></msub><annotation encoding="application/x-tex">n_s</annotation></semantics></math>
events are dispersed with a distance randomly drawn from a Gaussian
distribution. Additionally, TROLL model consider external seedrain
through
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mrow><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">n_{ext}</annotation></semantics></math>
events of seed immigration:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mrow><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>N</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi></mrow></msub><mo>*</mo><msub><mi>f</mi><mrow><mi>r</mi><mi>e</mi><mi>g</mi></mrow></msub><mo>*</mo><msub><mi>n</mi><mrow><mi>h</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">n_{ext} = N_{tot}*f_{reg}*n_{ha}</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">N_{tot}</annotation></semantics></math>
is the external seedrain per hectare (number of reproduction
opportunities).
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mrow><mi>r</mi><mi>e</mi><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">f_{reg}</annotation></semantics></math>
is the species’ regional frequency.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mrow><mi>h</mi><mi>a</mi></mrow></msub><annotation encoding="application/x-tex">n_{ha}</annotation></semantics></math>
is the simulated plot size in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">ha</annotation></semantics></math>.</p>
<p>Finally, a bank of seedlings to be recruited is defined for each
pixel. If the ground-level light reaches a species light compensation
point
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>C</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">LCP</annotation></semantics></math>
the species will be recruited:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>C</mi><mi>P</mi><mo>=</mo><mfrac><msub><mi>R</mi><mrow><mi>l</mi><mi>e</mi><mi>a</mi><mi>f</mi></mrow></msub><mi>ϕ</mi></mfrac></mrow><annotation encoding="application/x-tex">LCP = \frac{R_{leaf}}{\phi}</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mrow><mi>l</mi><mi>e</mi><mi>a</mi><mi>f</mi></mrow></msub><annotation encoding="application/x-tex">R_{leaf}</annotation></semantics></math>
is the leaf respiration for maintenance.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>
is the quantum yield
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mi>m</mi><mi>o</mi><mi>l</mi><mi>C</mi><mi>.</mi><mi>μ</mi><mi>m</mi><mi>o</mi><mi>l</mi><mspace width="0.222em"></mspace><mi>p</mi><mi>h</mi><mi>o</mi><mi>t</mi><mi>o</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">\mu mol C.\mu mol~photon</annotation></semantics></math>)
set to 0.06. If several species reach their
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>C</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">LCP</annotation></semantics></math>,
one is picked at random. Seedlings are recruited with following initial
geometry:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>d</mi><mi>b</mi><mi>h</mi><mo>=</mo><mfrac><msub><mi>a</mi><mi>h</mi></msub><mrow><msub><mi>h</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>−</mo><mn>1</mn></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>h</mi><mo>=</mo><mn>1</mn><mspace width="0.222em"></mspace><mi>m</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>C</mi><mi>R</mi><mo>=</mo><mn>0.5</mn><mspace width="0.222em"></mspace><mi>m</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>C</mi><mi>D</mi><mo>=</mo><mn>0.3</mn><mspace width="0.222em"></mspace><mi>m</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>L</mi><mi>D</mi><mo>=</mo><mn>0.8</mn><mspace width="0.222em"></mspace><msup><mi>m</mi><mn>2</mn></msup><msup><mi>.</mi><mrow><mo>−</mo><mn>3</mn></mrow></msup></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{c} \\ dbh = \frac{a_h}{h_{max} - 1}\\ h = 1~m\\ CR = 0.5~m\\ CD = 0.3~m\\ LD = 0.8~m^2.^{-3} \end{array}</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Pacala, S.W., Canham, C.D., Saponara, J., Silander, J.A., Kobe, R.K.
&amp; Ribbens, E. (1996). Forest models defined by field measurements:
estimation, error analysis and dynamics. Ecological Monographs, 66,
1–43.</p>
<p>Uriarte, M., Canham, C.D., Thompson, J., Zimmerman, J.K., Murphy, L.,
Sabat, A.M., Fetcher, N. &amp; Haines, B.L. (2009). Natural disturbance
and human land use as determinants of tropical forest dynamics: Results
from a forest simulator. Ecological Monographs, 79, 423–443.</p>
<p>Köhler, P. &amp; Huth, A. (1998). The effects of tree species
grouping in tropical rainforest modelling: Simulations with the
individual-based model FORMIND. Ecological Modelling, 109, 301–321.</p>
<p>Fischer, R., Bohn, F., Dantas de Paula, M., Dislich, C., Groeneveld,
J., Gutierrez, A. G., … Huth, A. (2016). Lessons learned from applying a
forest gap model to understand ecosystem and carbon dynamics of complex
tropical forests. Ecological Modelling, 326, 124–133. <a href="https://doi.org/10.1016/j.ecolmodel.2015.11.018" class="external-link uri">https://doi.org/10.1016/j.ecolmodel.2015.11.018</a></p>
<p>Maréchaux, I., &amp; Chave, J. (2017). An individual-based forest
model to jointly simulate carbon and tree diversity in Amazonia:
description and applications. Ecological Monographs, 87(4), 632–664.</p>
<p>Baraloto, C., Paine, C.E.T., Poorter, L., Beauchene, J., Bonal, D.,
Domenach, A.M., Hérault, B., Patiño, S., Roggy, J.C. &amp; Chave, J.
(2010). Decoupled leaf and stem economics in rain forest trees. Ecology
Letters, 13, 1338–1347.</p>
<p>Kattge, J., Diaz, S., Lavorel, S., Prentice, I. C., Leadley, P.,
Bonisch, G., … Wirth, C. (2011). TRY - a global database of plant
traits. Global Change Biology, 17(9), 2905–2935. <a href="doi:10.1111" class="uri">doi:10.1111</a></p>
<p>Meir, P., Grace, J. &amp; Miranda, A.C. (2000). Photographic method
to measure the vertical distribution of leaf area density in forests.
Agricultural and Forest Meteorology, 102, 105–111.</p>
<p>Farquhar, G.D., Caemmerer, S. von &amp; Berry, J.A. (1980). A
biochemical model of photosynthetic CO2 assimilation in leaves of C3
species. Planta, 149, 78–90.</p>
<p>Medlyn, B.E., Duursma, R.A., Eamus, D., Ellsworth, D.S., Prentice,
I.C., Barton, C.V.M., Crous, K.Y., De Angelis, P., Freeman, M. &amp;
Wingate, L. (2011). Reconciling the optimal and empirical approaches to
modelling stomatal conductance. Global Change Biology, 17,
2134–2144.</p>
<p>Wright, I.J., Reich, P.B., Westoby, M., Ackerly, D.D., Baruch, Z.,
Bongers, F., Cavender-Bares, J., Chapin, T., Cornelissen, J.H.C.,
Diemer, M. &amp; Others. (2004). The worldwide leaf economics spectrum.
Nature, 428, 821–827.</p>
<p>Domingues, T.F., Meir, P., Feldpausch, T.R., Saiz, G., Veenendaal,
E.M., Schrodt, F., Bird, M., Djagbletey, G., Hien, F., Compaore, H.,
Diallo, A., Grace, J. &amp; Lloyd, J. (2010). Co-limitation of
photosynthetic capacity by nitrogen and phosphorus in West Africa
woodlands. Plant, Cell and Environment, 33, 959–980.</p>
<p>Bernacchi, C.J., Pimentel, C. &amp; Long, S.P. (2003). In vivo
temperature response functions of parameters required to model
RuBP-limited photosynthesis. Plant, Cell and Environment, 26,
1419–1430.</p>
<p>Atkin, O.K., Bloomfield, K.J., Reich, P.B., Tjoelker, M.G., Asner,
G.P., Bonal, D., Bonisch, G., Bradford, M.G., Cernusak, L.A., Cosio,
E.G., Creek, D., Crous, K.Y., Domingues, T.F., Dukes, J.S., Egerton,
J.J.G., Evans, J.R., Farquhar, G.D., Fyllas, N.M., Gauthier, P.P.G.,
Gloor, E., Gimeno, T.E., Griffin, K.L., Guerrieri, R., Heskel, M.A.,
Huntingford, C., Ishida, F.Y., Kattge, J., Lambers, H., Liddell, M.J.,
Lloyd, J., Lusk, C.H., Martin, R.E., Maksimov, A.P., Maximov, T.C.,
Malhi, Y., Medlyn, B.E., Meir, P., Mercado, L.M., Mirotchnick, N., Ng,
D., Niinemets, ?., O’Sullivan, O.S., Phillips, O.L., Poorter, L., Poot,
P., Prentice, I.C., Salinas, N., Rowland, L.M., Ryan, M.G., Sitch, S.,
Slot, M., Smith, N.G., Turnbull, M.H., Vanderwel, M.C., Valladares, F.,
Veneklaas, E.J., Weerasinghe, L.K., Wirth, C., Wright, I.J., Wythers,
K.R., Xiang, J., Xiang, S. &amp; Zaragoza-Castells, J. (2015). Global
variability in leaf respiration in relation to climate, plant functional
types and leaf traits. New Phytologist, 206, 614–636.</p>
<p>Chave, J., Andalo, C., Brown, S., Cairns, M.A., Chambers, J.Q.,
Eamus, D., Fölster, H., Fromard, F., Higuchi, N., Kira, T., Lescure,
J.P., Nelson, B.W., Ogawa, H., Puig, H., Riéra, B. &amp; Yamakura, T.
(2005). Tree allometry and improved estimation of carbon stocks and
balance in tropical forests. Oecologia, 145, 87–99.</p>
<p>Chave, J., Coomes, D., Jansen, S., Lewis, S.L., Swenson, N.G. &amp;
Zanne, A.E. (2009). Towards a worldwide wood economics spectrum. Ecology
Letters, 12, 351–366.</p>
<p>Chave, J. (1999). Study of structural, successional and spatial
patterns in tropical rain forests using TROLL, a spatially explicit
forest model. Ecological Modelling, 124, 233–254.</p>
<p>Wright, S.J., Jaramillo, M.A., Pavon, J., Condit, R., Hubbell, S.P.
&amp; Foster, R.B. (2005). Reproductive size thresholds in tropical
trees: variation among individuals, species and forests. Journal of
Tropical Ecology, 21, 307–315.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Sylvain Schmitt, Guillaume Salzet, Fabian Fischer, Isabelle Maréchaux, Jérôme Chave.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
